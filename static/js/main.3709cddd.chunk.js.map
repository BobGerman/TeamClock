{"version":3,"sources":["components/Privacy.js","components/TermsOfUse.js","components/TimeStrip.js","components/TimeSelected.js","services/TeamService.js","components/Clock.js","components/TabConfig.js","components/App.js","index.js"],"names":["Privacy","React","Component","TermsOfUse","TimeStrip","props","state","context","currentMoment","moment","this","startTime","hours","cells","i","cellStyle","selectedColumn","isFirst","isLast","mouseOverColumn","push","className","onMouseOver","onMouseOut","onClick","headingClass","format","bodyClass","add","dayCode","workDays","substr","days","toLowerCase","hourCode","workHours","TimeSelected","selectedTime","TeamService","name","city","utcOffset","Clock","seletedColumn","microsoftTeams","error","setState","ex","teamMembers","getTeamMembers","memberIndex","now","map","m","col","handleMouseOver","handleMouseOut","handleClick","length","local","TabConfig","baseUrl","window","location","href","substring","indexOf","setSettings","setValidityState","TeamsHostError","App","parent","self","path","component","exact","ReactDOM","render","Provider","theme","themes","teams","document","getElementById"],"mappings":"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","file":"static/js/main.3709cddd.chunk.js","sourcesContent":["// Copyright (c) Microsoft Corporation. All rights reserved.\n// Licensed under the MIT License.\n\nimport React from 'react';\nimport './App.css';\n\n/**\n * This component is used to display the required\n * privacy statement which can be found in a link in the\n * about tab.\n */\nclass Privacy extends React.Component {\n    render() {\n      return (\n        <div>\n          <h1>Privacy Statement</h1>\n        </div>\n      );\n    }\n}\n\nexport default Privacy;","// Copyright (c) Microsoft Corporation. All rights reserved.\n// Licensed under the MIT License.\n\nimport React from 'react';\nimport './App.css';\n\n/**\n * This component is used to display the required\n * terms of use statement which can be found in a\n * link in the about tab.\n */\nclass TermsOfUse extends React.Component {\n    render() {\n      return (\n        <div>\n          <h1>Terms of Use</h1>\n        </div>\n      );\n    }\n}\n\nexport default TermsOfUse;","import React from 'react';\r\nimport moment from 'moment';\r\n\r\nclass TimeStrip extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            context: {}\r\n        }\r\n    }\r\n\r\n    render() {\r\n\r\n        let currentMoment = moment(this.props.startTime);\r\n        let hours = this.props.hours;\r\n\r\n        const cells = [];\r\n\r\n        for (let i = 0; i < hours; i++) {\r\n\r\n            let cellStyle = \"timeCell\";\r\n            if (i === this.props.selectedColumn) {\r\n                cellStyle += \" selected\";\r\n                if (this.props.isFirst) cellStyle += \" first\";\r\n                if (this.props.isLast) cellStyle += \" last\";\r\n            } else if (i === this.props.mouseOverColumn) {\r\n                cellStyle += \" mouseOver\";\r\n                if (this.props.isFirst) cellStyle += \" first\";\r\n                if (this.props.isLast) cellStyle += \" last\";\r\n            }\r\n\r\n            if (currentMoment.hours() === 0) {\r\n                // First hour - show the date\r\n                cells.push(\r\n                    <div className={cellStyle}\r\n                         onMouseOver={() => { this.props.onMouseOver(i)}}\r\n                         onMouseOut={() => { this.props.onMouseOut(i)}}\r\n                         onClick={() => { this.props.onClick(i)}}\r\n                         >\r\n                        <div className={this.headingClass(currentMoment)}>{currentMoment.format('MMMM')}</div>\r\n                        <div className={this.bodyClass(currentMoment)}>{currentMoment.format('DD')}</div>\r\n                    </div>\r\n                );\r\n            } else {\r\n                // Subsequent hours - show the time\r\n                cells.push(\r\n                    <div className={cellStyle}\r\n                         onMouseOver={() => { this.props.onMouseOver(i)}}\r\n                         onMouseOut={() => { this.props.onMouseOut(i)}}\r\n                         onClick={() => { this.props.onClick(i)}}\r\n                         >\r\n                        <div className={this.headingClass(currentMoment)}>{currentMoment.format('dddd')}</div>\r\n                        <div className={this.bodyClass(currentMoment)}>{currentMoment.format('h a')}</div>\r\n                    </div>\r\n                );\r\n            }\r\n            currentMoment.add(1, 'h');\r\n\r\n        }\r\n\r\n        return (\r\n            <div className=\"timeStrip\">\r\n                {cells}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    headingClass(currentMoment) {\r\n        if (currentMoment.hours() === 0) {  // first hour of the day (midnight)\r\n            return `timeHeader startOfDay`;\r\n        } else if (currentMoment.hours() === 23) {  // last hour of the day\r\n            return `timeHeader endOfDay`;\r\n        } else {\r\n            return `timeHeader`;\r\n        }\r\n    }\r\n\r\n    bodyClass(currentMoment) {\r\n\r\n        const dayCode = this.props.workDays.substr(currentMoment.days(),1).toLowerCase();\r\n        const hourCode = this.props.workHours.substr(currentMoment.hours(),1).toLowerCase();\r\n\r\n        let bodyClass = 'night';\r\n        if (dayCode === 'w' && hourCode !== 'n') {\r\n            bodyClass = hourCode === 'd' ? 'day' : 'extended';\r\n        }\r\n\r\n        if (currentMoment.hours() === 0) {\r\n            return `timeBody ${bodyClass} startOfDay`;\r\n        } else if (currentMoment.hours() === 23) {\r\n            return `timeBody ${bodyClass} endOfDay`;\r\n        } else {\r\n            return `timeBody ${bodyClass}`;\r\n        }\r\n    };\r\n}\r\nexport default TimeStrip;","import React from 'react';\r\nimport moment from 'moment';\r\n\r\nclass TimeSelected extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            context: {}\r\n        }\r\n    }\r\n\r\n    render() {\r\n\r\n        let selectedTime = moment(this.props.startTime)\r\n            .add(this.props.selectedColumn, 'hours');\r\n        if (this.props.selectedColumn >= 0) {\r\n            return (\r\n                <div className=\"timeSelected\">\r\n                    You have selected {selectedTime.format(\"h:00 a on dddd, MMMM Do YYYY\")} in your local time zone.\r\n                </div>\r\n            );    \r\n        } else {\r\n            return (<div />);\r\n        }\r\n    }\r\n}\r\n\r\nexport default TimeSelected;","export default class TeamService{\r\n\r\n    getTeamMembers () {\r\n        return [\r\n            {\r\n                name: 'Ayca',\r\n                city: 'Dubai',\r\n                utcOffset: 4,\r\n                /* Preferred work week, 1 char/day, o=off, w=work */\r\n                workDays: 'owwwwwo',\r\n                /* Preferred work day, 1 char/hour, n=night, e=extended, d=day */\r\n                workHours: 'nnnnnnneedddddddddeeeeen',\r\n            },\r\n            {\r\n                name: 'Barnam',\r\n                city: 'Melbourne',\r\n                utcOffset: 10,\r\n                workDays: 'owwwwwo',\r\n                workHours: 'nnnnnnneedddddddddeeeeen',\r\n            },\r\n            {\r\n                name: 'Bob',\r\n                city: 'Boston',\r\n                utcOffset: -4,\r\n                workDays: 'owwwwwo',\r\n                workHours: 'nnnnnnneedddddddddeeeeen',\r\n            },\r\n            {\r\n                name: 'Dan',\r\n                city: 'Phoenix',\r\n                utcOffset: -6,\r\n                workDays: 'owwwwwo',\r\n                workHours: 'nnnnnnneedddddddddeeeeen',\r\n            },\r\n            {\r\n                name: 'Emily',\r\n                city: 'Bay area',\r\n                utcOffset: -7,\r\n                workDays: 'owwwwwo',\r\n                workHours: 'nnnnnnneedddddddddeeeeen',\r\n            },\r\n            {\r\n                name: 'Matt',\r\n                city: 'Bay area',\r\n                utcOffset: -7,\r\n                workDays: 'owwwwwo',\r\n                workHours: 'nnnnnnneedddddddddeeeeen',\r\n            },\r\n            {\r\n                name: 'Todd',\r\n                city: 'Austin',\r\n                utcOffset: -5,\r\n                workDays: 'owwwwwo',\r\n                workHours: 'nnnnnnneedddddddddeeeeen',\r\n            },\r\n            {\r\n                name: 'Tomomi',\r\n                city: 'Bay area',\r\n                utcOffset: -7,\r\n                workDays: 'owwwwwo',\r\n                workHours: 'nnnnnnneedddddddddeeeeen',\r\n            },\r\n        ]\r\n    }\r\n\r\n}","import React from 'react';\nimport moment from 'moment';\nimport './Clock.css';\nimport TimeStrip from './TimeStrip';\nimport TimeSelected from './TimeSelected';\nimport * as microsoftTeams from \"@microsoft/teams-js\";\nimport TeamService from '../services/TeamService';\n\nclass Clock extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      context: {},\n      mouseOverColumn: -1,\n      seletedColumn: -1,\n    }\n  }\n\n  componentDidMount() {\n    // Get the user context from Teams and set it in the state\n    if (microsoftTeams) {\n      try {\n        microsoftTeams.getContext((context, error) => {\n          if (context) {\n            this.setState({\n              context: context\n            });  \n          }\n        });\n      }\n      catch (ex) { }\n    }\n  }\n\n  render() {\n\n    // let userName = Object.keys(this.state.context).length > 0 ? this.state.context['upn'] : \"\";\n\n    const teamMembers = (new TeamService()).getTeamMembers();\n    let memberIndex = 0;\n    const now = moment();\n\n    return (\n      <div className=\"teamClock\">\n        <div>\n          <div className=\"personList\">\n            {teamMembers.map((m) => {\n              return <div className=\"person\">\n                <p className=\"personName\">{m.name}</p>\n                <p className=\"personCity\">{m.city}</p>\n              </div>;\n            }) }\n          </div>\n          <div className=\"scrollingWrapper\">\n            {teamMembers.map((m) => {\n                return <TimeStrip hours={24*7} \n                  startTime={moment(now.utcOffset(m.utcOffset*60))}\n                  mouseOverColumn={this.state.mouseOverColumn}\n                  selectedColumn={this.state.selectedColumn}\n                  onMouseOver={(col) => this.handleMouseOver(col)}\n                  onMouseOut={(col) => this.handleMouseOut(col)}\n                  onClick={(col) => this.handleClick(col)} \n                  workDays={m.workDays}\n                  workHours={m.workHours}\n                  isFirst={memberIndex === 0}\n                  isLast={memberIndex++ === teamMembers.length} \n                  />;\n              }) }\n          </div>\n        </div>\n        <TimeSelected \n                  startTime={moment(now.local())}\n                  selectedColumn={this.state.selectedColumn} />\n      </div>\n    );\n  }\n\n  handleMouseOver(col) {\n    this.setState({\n      mouseOverColumn: col\n    })\n  }\n\n  handleMouseOut(col) {\n    if (this.state.mouseOverColumn === col) {\n      this.setState({\n        mouseOverColumn: -1\n      })\n    }\n  }\n\n  handleClick(col) {\n    this.setState({\n      mouseOverColumn: -1,\n      selectedColumn: col\n    })\n  }\n\n\n}\nexport default Clock;","// Copyright (c) Microsoft Corporation. All rights reserved.\n// Licensed under the MIT License.\n\nimport React from 'react';\nimport './App.css';\nimport * as microsoftTeams from \"@microsoft/teams-js\";\n\n/**\n * The 'Config' component is used to display your group tabs\n * user configuration options.  Here you will allow the user to \n * make their choices and once they are done you will need to validate\n * thier choices and communicate that to Teams to enable the save button.\n */\nclass TabConfig extends React.Component {\n    render() {\n      /**\n       * The content url for the tab is a required value that must be set.\n       * The url value is the source url for your configured tab.\n       * This allows for the addition of query string parameters based on\n       * the settings selected by the user.\n       */\n      const baseUrl = window.location.href.substring(0,window.location.href.indexOf(\"#/\")+1);\n      microsoftTeams.settings.setSettings({\"contentUrl\": `${baseUrl}/tab`});\n  \n      /**\n       * After verifying that the settings for your tab are correctly\n       * filled in by the user you need to set the state of the dialog\n       * to be valid.  This will enable the save button in the configuration\n       * dialog.\n       */\n      microsoftTeams.settings.setValidityState(true);\n  \n      return (\n        <div>\n          <h1>Tab Configuration</h1>\n          <div>\n            This is where you will add your tab configuration options the user\n            can choose when the tab is added to your team/group chat.            \n          </div>\n        </div>\n      );\n    }\n  }\n\n  export default TabConfig;","import React from 'react';\nimport './App.css';\nimport * as microsoftTeams from \"@microsoft/teams-js\";\nimport { HashRouter as Router, Route } from \"react-router-dom\";\nimport Privacy from \"./Privacy\";\nimport TermsOfUse from \"./TermsOfUse\";\nimport Clock from './Clock';\nimport TabConfig from './TabConfig';\n\n/**\n * The main app which handles the initialization and routing\n * of the app.\n */\nfunction App() {\n  // Check for the Microsoft Teams SDK object.\n  if (microsoftTeams) {\n\n    // Set app routings that don't require microsoft Teams\n    // SDK functionality.  Show an error if trying to access the\n    // Home page.\n    if (window.parent === window.self) {\n      return (\n        <Router>\n          <Route path=\"/privacy\" component={Privacy} />\n          <Route path=\"/termsofuse\" component={TermsOfUse} />\n          <Route path=\"/tab\" component={TeamsHostError} />\n          <Route path=\"/config\" component={TeamsHostError} />\n          <Route path=\"/\" component={Clock} />\n        </Router>        \n      );\n    }\n\n    // Initialize the Microsoft Teams SDK\n    microsoftTeams.initialize(window);\n\n    // Display the app home page hosted in Teams\n    return (\n      <Router>\n        <Route exact path=\"/tab\" component={Clock} />\n        <Route exact path=\"/config\" component={TabConfig} />\n      </Router>\n    );\n  }\n\n  // Error when the Microsoft Teams SDK is not found\n  // in the project.\n  return (\n    <h3>Microsoft Teams SDK not found.</h3>\n  );\n}\n\n/**\n * This component displays an error message in the\n * case when a page is not being hosted within Teams.\n */\nclass TeamsHostError extends React.Component {\n  render() {\n    return (\n      <div>\n        <h3 className=\"Error\">Debug your app within the Teams client.</h3>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './components/App';\nimport { Provider, themes } from '@fluentui/react-northstar' //https://fluentsite.z22.web.core.windows.net/quick-start\n\nReactDOM.render(\n    <Provider theme={themes.teams}>\n        <App />\n    </Provider>, document.getElementById('root')\n);\n"],"sourceRoot":""}